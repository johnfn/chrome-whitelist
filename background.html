<!DOCTYPE html>

<html>
  <head>
    <script>

      /* The problem that I'm trying to solve is to store all the indirect links
      in the background.html page. */

      var tabStorage = {};
      chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
        debugger;
          if(request.cmd == "save") {
              tabStorage[request.key] = request.value;
          }

          if(request.cmd == "load") {
              sendResponse(tabStorage[request.key]);
          }
      });

      // Called when the url of a tab changes.
      function checkForValidUrl(tabId, changeInfo, tab) {
        var url = tab.url;

        /* Check to see if the page is finished loading. */
        if (changeInfo.status != 'complete') return;
        if (url.indexOf("extensions") != -1) return; //Imagine how bad that would be.

        chrome.tabs.executeScript(null, {file: "block_site.js"});
      }

      // Listen for any changes to the URL of any tab.
      chrome.tabs.onUpdated.addListener(checkForValidUrl);
    </script>
  </head>
</html>
